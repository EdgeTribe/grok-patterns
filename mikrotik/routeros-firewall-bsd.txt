# These can be used as-is in Logstash
# For Vector, you have to escape the brackets. Like this: \\(


# Firewall Log (No NAT):
MIKROTIKFIREWALLNONAT <%{INT:log.syslog.number}>%{GREEDYDATA:event.date} %{DATA:observer.name} %{DATA:firewall.chain}: in:%{DATA:observer.ingress.interface.name} out:%{DATA:observer.egress.interface.name}, connection-state:%{DATA:network.connection.state} src-mac %{DATA:network.mac_address}, proto %{DATA:network.transport}, %{IP:source.address}:%{INT:source.port}->%{IP:destination.address}:%{INT:destination.port}, len %{INT:network.bytes}

# Firewall Log (NAT):
MIKROTIKFIREWALLDSTNAT <%{INT:log.syslog.number}>%{GREEDYDATA:event.date} %{DATA:observer.name} %{DATA:firewall.chain}: in:%{DATA:observer.ingress.interface.name} out:%{DATA:observer.egress.interface.name}, connection-state:%{DATA:network.connection.state} src-mac %{DATA:network.mac_address}, proto %{DATA:network.transport}, %{IP:source.address}:%{INT:source.port}->%{IP:destination.address}:%{INT:destination.port}, NAT %{IP:network.nat.source.address}:%{INT:network.nat.source.port}->\(%{IP:network.nat.destination.address}:%{INT:network.nat.destination.port}->%{IP:network.nat.translated.address}:%{INT:network.nat.translated.port}\), len %{INT:network.bytes}
MIKROTIKFIREWALLSRCNAT <%{INT:log.syslog.number}>%{GREEDYDATA:event.date} %{DATA:observer.name} %{DATA:firewall.chain}: in:%{DATA:observer.ingress.interface.name} out:%{DATA:observer.egress.interface.name}, connection-state:%{DATA:network.connection.state} src-mac %{DATA:network.mac_address}, proto %{DATA:network.transport}, %{IP:source.address}:%{INT:source.port}->%{IP:destination.address}:%{INT:destination.port}, NAT %{IP:network.nat.source.address}:%{INT:network.nat.source.port}->\(%{IP:network.nat.destination.address}:%{INT:network.nat.destination.port}->%{IP:network.nat.translated.address}:%{INT:network.nat.translated.port}\), len %{INT:network.bytes}
MIKROTIKFIREWALLSRCNAT2 <%{INT:log.syslog.number}>%{GREEDYDATA:event.date} %{DATA:observer.name} %{DATA:firewall.chain}: in:%{DATA:observer.ingress.interface.name} out:%{DATA:observer.egress.interface.name}, connection-state:%{DATA:network.connection.state} src-mac %{DATA:network.mac_address}, proto %{DATA:network.transport}, %{IP:source.address}:%{INT:source.port}->%{IP:destination.address}:%{INT:destination.port}, NAT \(%{IP:network.nat.source.address}:%{INT:network.nat.source.port}->%{IP:network.nat.translated.address}:%{INT:network.nat.translated.port}\)->%{IP:network.nat.destination.address}:%{INT:network.nat.destination.port}, len %{INT:network.bytes}
MIKROTIKFIREWALLNATPRIO <%{INT:log.syslog.number}>%{GREEDYDATA:event.date} %{DATA:observer.name} %{DATA:firewall.chain}: in:%{DATA:observer.ingress.interface.name} out:%{DATA:observer.egress.interface.name}, connection-state:%{DATA:network.connection.state} src-mac %{DATA:network.mac_address}, proto %{DATA:network.transport}, %{IP:source.address}:%{INT:source.port}->%{IP:destination.address}:%{INT:destination.port}, NAT \(%{IP:network.nat.source.address}:%{INT:network.nat.source.port}->%{IP:network.nat.translated.address}:%{INT:network.nat.translated.port}\)->%{IP:network.nat.destination.address}:%{INT:network.nat.destination.port}, prio %{INT}->%{INT}, len %{INT:network.bytes}
MIKROTIKFIREWALLNONATPRIO <%{INT:log.syslog.number}>%{GREEDYDATA:event.date} %{DATA:observer.name} %{DATA:firewall.chain}: in:%{DATA:observer.ingress.interface.name} out:%{DATA:observer.egress.interface.name}, connection-state:%{DATA:network.connection.state} src-mac %{DATA:network.mac_address}, proto %{DATA:network.transport}, %{IP:source.address}:%{INT:source.port}->%{IP:destination.address}:%{INT:destination.port}, prio %{DATA:network.prio}, len %{INT:network.bytes}
MIKROTIKFIREWALLNATICMP <%{INT:log.syslog.number}>%{GREEDYDATA:event.date} %{DATA:observer.name} %{DATA:firewall.chain}: in:%{DATA:observer.ingress.interface.name} out:%{DATA:observer.egress.interface.name}, connection-state:%{DATA:network.connection.state} src-mac %{DATA:network.mac_address}, proto %{DATA:network.transport}, %{IP:source.address}->%{IP:destination.address}, len %{INT:network.bytes}
MIKROTIKFIREWALLNATICMP2 <%{INT:log.syslog.number}>%{GREEDYDATA:event.date} %{DATA:observer.name} %{DATA:firewall.chain}: in:%{DATA:observer.ingress.interface.name} out:%{DATA:observer.egress.interface.name}, connection-state:%{DATA:network.connection.state} src-mac %{DATA:network.mac_address}, proto %{DATA:network.transport}, %{IP:source.address}->%{IP:destination.address}, NAT %{IP:network.nat.source.address}->\(%{IP:network.nat.destination.address}->%{IP:network.nat.translated.address}\), len %{INT:network.bytes}
MIKROTIKFIREWALLNATICMP3 <%{INT:log.syslog.number}>%{GREEDYDATA:event.date} %{DATA:observer.name} %{DATA:firewall.chain}: in:%{DATA:observer.ingress.interface.name} out:%{DATA:observer.egress.interface.name}, connection-state:%{DATA:network.connection.state} src-mac %{DATA:network.mac_address}, proto %{DATA:network.transport}, %{IP:source.address}->%{IP:destination.address}, NAT \(%{IP:network.nat.source.address}->%{IP:network.nat.translated.address}\)->%{IP:network.nat.destination.address}, len %{INT:network.bytes}
MIKROTIKFIREWALLINPUT <%{INT:log.syslog.number}>%{GREEDYDATA:event.date} %{DATA:observer.name} %{DATA:firewall.chain}: in:%{DATA:observer.ingress.interface.name} out:%{DATA:observer.egress.interface.name}, connection-state:%{DATA:network.connection.state} src-mac %{DATA:network.mac_address}, proto %{DATA:network.transport}, %{IP:source.address}:%{INT:source.port}->%{IP:destination.address}:%{INT:destination.port}, prio %{DATA:network.prio}, len %{INT:network.bytes}

MIKROTIKFIREWALL (?:%{MIKROTIKFIREWALLDSTNAT}|%{MIKROTIKFIREWALLSRCNAT}|%{MIKROTIKFIREWALLSRCNAT2}|%{MIKROTIKFIREWALLNATPRIO}|%{MIKROTIKFIREWALLNONATPRIO}|%{MIKROTIKFIREWALLNONAT}|%{MIKROTIKFIREWALLNATICMP}|%{MIKROTIKFIREWALLNATICMP2}|%{MIKROTIKFIREWALLNATICMP3}|%{MIKROTIKFIREWALLINPUT})
